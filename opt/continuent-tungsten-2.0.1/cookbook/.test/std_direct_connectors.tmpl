# std_direct_connectors : install a single Continuent Tungsten cluster with direct connections to slaves

# To run this cookbook:
# 1.  Modify the USER_VALUES.sh file in this directory
# 2.  Uncomment the USER_VALUES.sh line below
# 3.  Run the cookbook from the top-level directory
#     tungsten-enterprise-1.5.0 $>. ./cookbook/std.tmpl

# Loads environment variables to fill in the cookbook
# . cookbook/USER_VALUES.sh

tools/tpm configure defaults --reset \
    --log=timestamp \
    --datasource-port=$DATASOURCE_PORT \
    --home-directory=$CONTINUENT_ROOT \
    --user=$USER \
    --datasource-user=$DATASOURCE_USER \
    --datasource-password=$DATASOURCE_PASSWORD \
    --application-user=$APPLICATION_USER \
    --application-password=$APPLICATION_PASSWORD \
    --connector-listen-port=$APPLICATION_PORT \
    --mysql-connectorj-path=$CONNECTORJ \
    --root-command-prefix=$ROOT_COMMAND \
    --datasource-boot-script=$DATASOURCE_BOOT_SCRIPT \
    --datasource-mysql-conf=$MYSQL_CONF \
    --datasource-log-directory=$MYSQL_BINARY_LOG_DIRECTORY \
    --profile-script=$PROFILE_SCRIPT \
    $MORE_OPTIONS \
    $START_OPTION

tools/tpm configure $DS_NAME \
    --dataservice-hosts=$MASTER,$SLAVES \
    --dataservice-connectors=$CONNECTORS \
    --dataservice-master-host=$MASTER 

#    --dataservice-witnesses=$WITNESS 

tools/tpm configure $DS_NAME --hosts=$CONNECTORS --connector-ro-addresses=$CONNECTOR_DIRECT_RO 

tools/tpm install $DS_NAME

